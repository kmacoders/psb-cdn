!function(){"use strict";var t=function(t){return this._sizes=[],this._columns=[],this._container=null,this._count=null,this._width=0,this._removeListener=null,this._currentGutterX=null,this._currentGutterY=null,this._resizeTimeout=null,this.conf={baseWidth:255,gutterX:null,gutterY:null,gutter:10,container:null,minify:!0,ultimateGutter:5,surroundingGutter:!0,direction:"ltr",wedge:!1},this.init(t),this};t.prototype.init=function(t){for(var e in this.conf)null!=t[e]&&(this.conf[e]=t[e]);if(null!=this.conf.gutterX&&null!=this.conf.gutterY||(this.conf.gutterX=this.conf.gutterY=this.conf.gutter),this._currentGutterX=this.conf.gutterX,this._currentGutterY=this.conf.gutterY,console.log(this._currentGutterX),this._container="object"==typeof this.conf.container&&this.conf.container.nodeName?this.conf.container:document.querySelector(this.conf.container),!this._container)throw new Error("Container not found or missing");var i=this.resizeThrottler.bind(this);window.addEventListener("resize",i),this._removeListener=function(){window.removeEventListener("resize",i)},this.layout()},t.prototype.reset=function(){this._sizes=[],this._columns=[],this._count=null,this._width=this._container.clientWidth;var t=this.conf.baseWidth;this._width<t&&(this._width=t,this._container.style.minWidth=t+"px"),1==this.getCount()?(this._currentGutterX=this.conf.ultimateGutter,this._count=1):this._width<this.conf.baseWidth+2*this._currentGutterX?this._currentGutterX=0:this._currentGutterX=this.conf.gutterX},t.prototype.getCount=function(){return this.conf.surroundingGutter?Math.floor((this._width-this._currentGutterX)/(this.conf.baseWidth+this._currentGutterX)):Math.floor((this._width+this._currentGutterX)/(this.conf.baseWidth+this._currentGutterX))},t.prototype.computeWidth=function(){var t;return t=this.conf.surroundingGutter?(this._width-this._currentGutterX)/this._count-this._currentGutterX:(this._width+this._currentGutterX)/this._count-this._currentGutterX,Number.parseFloat(t.toFixed(2))},t.prototype.layout=function(){if(this._container){this.reset(),null==this._count&&(this._count=this.getCount());for(var t=this.computeWidth(),e=0;e<this._count;e++)this._columns[e]=0;for(var i,n=this._container.children,r=0;r<n.length;r++)n[r].style.width=t+"px",this._sizes[r]=n[r].clientHeight;if(i="ltr"==this.conf.direction?this.conf.surroundingGutter?this._currentGutterX:0:this._width-(this.conf.surroundingGutter?this._currentGutterX:0),this._count>this._sizes.length){var s=this._sizes.length*(t+this._currentGutterX)-this._currentGutterX;!1===this.conf.wedge?i="ltr"==this.conf.direction?(this._width-s)/2:this._width-(this._width-s)/2:"ltr"==this.conf.direction||(i=this._width-this._currentGutterX)}for(var o=0;o<n.length;o++){var h,u=this.conf.minify?this.getShortest():this.getNextColumn(o),c=0;(this.conf.surroundingGutter||u!=this._columns.length)&&(c=this._currentGutterX),h="ltr"==this.conf.direction?i+(t+c)*u:i-(t+c)*u-t;var l=this._columns[u];n[o].style.transform="translate3d("+Math.round(h)+"px,"+Math.round(l)+"px,0)",this._columns[u]+=this._sizes[o]+(this._count>1?this.conf.gutterY:this.conf.ultimateGutter)}this._container.style.height=this._columns[this.getLongest()]-this._currentGutterY+"px"}else console.error("Container not found")},t.prototype.getNextColumn=function(t){return t%this._columns.length},t.prototype.getShortest=function(){for(var t=0,e=0;e<this._count;e++)this._columns[e]<this._columns[t]&&(t=e);return t},t.prototype.getLongest=function(){for(var t=0,e=0;e<this._count;e++)this._columns[e]>this._columns[t]&&(t=e);return t},t.prototype.resizeThrottler=function(){this._resizeTimeout||(this._resizeTimeout=setTimeout(function(){this._resizeTimeout=null,this._container.clientWidth!=this._width&&this.layout()}.bind(this),33))},t.prototype.destroy=function(){"function"==typeof this._removeListener&&this._removeListener();for(var t=this._container.children,e=0;e<t.length;e++)t[e].style.removeProperty("width"),t[e].style.removeProperty("transform");this._container.style.removeProperty("height"),this._container.style.removeProperty("min-width")};class e extends HTMLElement{constructor(){super(),this.masonryContainer=this.querySelector(".psb-masonry-container"),this.config={baseWidth:Number(this.getAttribute("data-base-width"))||300,gutter:Number(this.getAttribute("data-gutter"))||10,ultimateGutter:Number(this.getAttribute("data-ultimate-gutter"))||5},Shopify.designMode?(document.addEventListener("shopify:section:load",(()=>{this.init()})),document.addEventListener("shopify:inspector:activate",(()=>{this.init()}))):this.init()}init(){const{baseWidth:e,gutter:i,ultimateGutter:n}=this.config,r={container:this.masonryContainer,surroundingGutter:!1,baseWidth:e,gutter:i,ultimateGutter:n};let s=new t(r);window.addEventListener("resize",(()=>{console.log("Masonry resize"),s.destroy(),s=new t(r)})),setTimeout((()=>{console.log("Masonry update first time load page"),s.destroy(),s=new t(r)}),2e3)}}customElements.define("psb-masonry",e)}();